{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Dashboard de Ocorr\u00eancias com Power BI","text":"<p>Este guia explica como transformar dados de uma planilha do Google Sheets em um servi\u00e7o JSON acess\u00edvel e integr\u00e1-lo ao Power BI para cria\u00e7\u00e3o de dashboards din\u00e2micos com m\u00e9tricas personalizadas.</p>"},{"location":"metricas/","title":"\ud83d\udcca M\u00e9tricas DAX no Power BI para An\u00e1lise de Ocorr\u00eancias","text":"<p>Este documento apresenta e explica as principais medidas DAX utilizadas no Power BI para an\u00e1lise de dados de ocorr\u00eancias, extra\u00eddos de uma planilha Google convertida para JSON via Google Apps Script.</p>"},{"location":"metricas/#contagem-total-de-ocorrencias","title":"\u2705 Contagem total de ocorr\u00eancias","text":"<pre><code>Total Ocorr\u00eancias = COUNTROWS(exec)\n</code></pre> <ul> <li>Conta o n\u00famero total de linhas da tabela <code>exec</code>, que representa todas as ocorr\u00eancias.</li> <li>\u00datil para obter o total geral de registros.</li> </ul>"},{"location":"metricas/#contagem-de-titulos-preenchidos-nao-nulos","title":"\u2705 Contagem de t\u00edtulos preenchidos (n\u00e3o nulos)","text":"<pre><code>Ocorr\u00eancias com T\u00edtulo = COUNTA(exec[T\u00edtulo da Ocorr\u00eancia])\n</code></pre> <ul> <li>Conta quantos registros t\u00eam a coluna <code>T\u00edtulo da Ocorr\u00eancia</code> preenchida.</li> <li>Ignora valores vazios/nulos.</li> </ul>"},{"location":"metricas/#ocorrencias-do-tipo-assistencial","title":"\u2705 Ocorr\u00eancias do tipo \"assistencial\"","text":"<pre><code>Assistenciais = \nCALCULATE(\n    COUNTROWS(exec),\n    exec[Tipo de Ocorr\u00eancia] = \"Assistencial\"\n)\n</code></pre> <ul> <li>Conta apenas as linhas onde o tipo de ocorr\u00eancia \u00e9 <code>\"assistencial\"</code>.</li> <li>\u00datil para filtrar por tipo espec\u00edfico.</li> </ul>"},{"location":"metricas/#ocorrencias-distintas-sem-repeticoes","title":"\u2705 Ocorr\u00eancias distintas (sem repeti\u00e7\u00f5es)","text":"<pre><code>Ocorr\u00eancias Distintas = DISTINCTCOUNT(exec[T\u00edtulo da Ocorr\u00eancia])\n</code></pre> <ul> <li>Conta quantos t\u00edtulos \u00fanicos existem na base.</li> <li>Ideal para evitar contagens duplicadas de registros com nomes repetidos.</li> </ul>"},{"location":"metricas/#observacoes-importantes","title":"\ud83d\udd0d Observa\u00e7\u00f5es importantes","text":"<ul> <li>A tabela <code>exec</code> deve estar corretamente nomeada no modelo do Power BI (caso contr\u00e1rio, substitua pelo nome real da tabela).</li> <li>Os nomes das colunas entre colchetes (<code>[ ]</code>) devem corresponder exatamente aos nomes presentes no modelo de dados.</li> </ul>"},{"location":"metricas/#dicas-adicionais","title":"\ud83d\udca1 Dicas adicionais","text":"<ul> <li>Use segmenta\u00e7\u00f5es (filtros visuais) no Power BI para cruzar essas m\u00e9tricas por per\u00edodo, status ou setor.</li> <li>Combine medidas com gr\u00e1ficos de barras, contadores e cart\u00f5es para melhor visualiza\u00e7\u00e3o.</li> </ul>"},{"location":"metricas/#sugestao-de-metricas-avancadas","title":"\ud83e\udde0 Sugest\u00e3o de M\u00e9tricas Avan\u00e7adas","text":"<ul> <li>Tempo m\u00e9dio de resolu\u00e7\u00e3o</li> <li>Percentual de assistenciais vs total</li> <li>T\u00edtulos mais frequentes</li> <li>Tend\u00eancia mensal de registros</li> </ul>"},{"location":"sheets-to-json/","title":"Converter Planilha Google em JSON via Apps Script","text":""},{"location":"sheets-to-json/#1-acesse-o-editor-de-script","title":"1. Acesse o Editor de Script","text":"<ul> <li>No Google Sheets: <code>Extens\u00f5es \u2192 Apps Script</code></li> </ul>"},{"location":"sheets-to-json/#2-cole-o-codigo-abaixo","title":"2. Cole o c\u00f3digo abaixo","text":"<pre><code>function doGet(e) {\n  var ss = SpreadsheetApp.openById('');\n\n  var nome_aba = ('BASE');  \n  var sheet = ss.getSheetByName(nome_aba);\n\n  if (!sheet) {\n    return ContentService\n      .createTextOutput(JSON.stringify({ error: `A aba '${nome_aba}' n\u00e3o foi encontrada.` }))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n\n  var data = sheet.getDataRange().getValues();\n  var headers = data[0];\n\n  var jsonData = data.slice(1).map(function(row) {\n    var obj = {};\n    headers.forEach(function(header, i) {\n      obj[header] = row[i];\n    });\n    return obj;\n  });\n\n  return ContentService\n    .createTextOutput(JSON.stringify(jsonData))\n    .setMimeType(ContentService.MimeType.JSON);\n}\n</code></pre>"},{"location":"sheets-to-json/#objetivo","title":"\ud83d\udccc Objetivo","text":"<ul> <li>Acessar uma planilha Google pelo seu ID</li> <li>Ler os dados da aba chamada <code>\"BASE\"</code></li> <li>Transformar os dados em JSON</li> <li>Retornar esse JSON como resposta da API p\u00fablica</li> </ul>"},{"location":"sheets-to-json/#codigo-comentado","title":"\ud83d\udcdc C\u00f3digo comentado","text":"<pre><code>function doGet(e) {\n  // 1. Abre a planilha pelo ID (deve ser preenchido com o ID real)\n  var ss = SpreadsheetApp.openById('');\n\n  // 2. Define o nome da aba a ser acessada\n  var nome_aba = ('BASE');  \n\n  // 3. Tenta obter a aba pelo nome\n  var sheet = ss.getSheetByName(nome_aba);\n\n  // 4. Se a aba n\u00e3o for encontrada, retorna um erro em JSON\n  if (!sheet) {\n    return ContentService\n      .createTextOutput(JSON.stringify({ error: `A aba '${nome_aba}' n\u00e3o foi encontrada.` }))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n\n  // 5. L\u00ea todos os dados da aba (inclusive cabe\u00e7alho)\n  var data = sheet.getDataRange().getValues();\n\n  // 6. Separa a primeira linha como os nomes das colunas (headers)\n  var headers = data[0];\n\n  // 7. Transforma cada linha em um objeto JSON\n  var jsonData = data.slice(1).map(function(row) {\n    var obj = {};\n    headers.forEach(function(header, i) {\n      obj[header] = row[i];  // Associa o valor \u00e0 respectiva chave\n    });\n    return obj;\n  });\n\n  // 8. Retorna os dados como texto JSON com MIME do tipo application/json\n  return ContentService\n    .createTextOutput(JSON.stringify(jsonData))\n    .setMimeType(ContentService.MimeType.JSON);\n}\n</code></pre>"},{"location":"sheets-to-json/#conectar-power-bi-ao-json-do-apps-script","title":"Conectar Power BI ao JSON do Apps Script","text":""},{"location":"sheets-to-json/#1-abra-o-power-bi-desktop","title":"1. Abra o Power BI Desktop","text":"<ul> <li>V\u00e1 em \"Obter Dados\" \u2192 Web</li> </ul>"},{"location":"sheets-to-json/#2-insira-a-url-da-api-json","title":"2. Insira a URL da API JSON","text":""},{"location":"sheets-to-json/#3-transformar-os-dados","title":"3. Transformar os Dados","text":"<ul> <li>O Power BI abrir\u00e1 o conte\u00fado como JSON</li> <li>Clique em \"Transformar dados\"</li> <li>Use o bot\u00e3o de expandir (\u00edcone de duas setas \u2194\ufe0f) para abrir os campos</li> </ul>"},{"location":"sheets-to-json/#4-carregar-no-modelo","title":"4. Carregar no Modelo","text":"<ul> <li>Ap\u00f3s expandir os dados, clique em \"Fechar e Aplicar\"</li> </ul>"}]}